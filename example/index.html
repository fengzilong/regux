<html>
<head>
	<meta charset="utf-8">
	<title>regux demo</title>
</head>
<body>
	<script type="text/javascript" src="./regular.js"></script>
	<script type="text/javascript" src="../dist/regux.js"></script>
	<script type="text/javascript" src="../logger.js"></script>
	<script type="text/javascript">
		Regular.use( regux );

		const App = Regular.extend({
			template: `
				<div>
					{ count }
					<button on-click="{ this.onAdd( 10 ) }">+</button>
					<button on-click="{ this.onSubtract( 5 ) }">-</button>
				</div>
			`,
			regux: {
				getters: {
					count: function( state ) {
						return state.foo.bar;
					}
				},
				actions: {
					onAdd( store, num ) {
						store.dispatch( { type: 'ADD2', payload: num } );
					},
					onSubtract( store, num ) {
						store.dispatch( { type: 'SUBTRACT2', payload: num } );
					}
				},
			}
		});

		const state = {
			c: 0
		};

		const mutations = {
			ADD( state, mutation ) {
				state.c = state.c + mutation.payload;
			},
			SUBTRACT( state, mutation ) {
				state.c = state.c - mutation.payload;
			}
		};

		const foo = {
			state: { bar: 10 },
			mutations: {
				ADD2( state, mutation ) {
					state.bar = state.bar + mutation.payload;
				},
				SUBTRACT2( state, mutation ) {
					state.bar = state.bar - mutation.payload;
				}
			}
		};

		const store = new regux.Store({
			state,
			mutations,
			modules: {
				foo: foo
			},
			plugins: [ logger( { collapsed: true } ) ]
		});

		// inject store into child components on top level
		new App( { store: store } ).$inject( document.body );
	</script>
</body>
</html>
